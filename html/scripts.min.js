'use strict';

(function () {

    var accordion = document.querySelector('#js-faqs');

    var initAll = function initAll() {
        Accordion();
        LoadData();
    }; // initAll

    var LoadData = function LoadData() {
        var request = new XMLHttpRequest();
        request.open('GET', 'data.json', true);

        request.onload = function () {
            if (this.status >= 200 && this.status < 400) {
                var data = JSON.parse(this.response);
                data && CreateList(data);ScrollBar();
            } else {
                console.error('server returned an error');
            }
        };

        request.onerror = function () {
            console.error('There was a connection error of some sort');
        };

        request.send();
    }; // LoadData

    var Accordion = function Accordion() {

        accordion.addEventListener('click', function (event) {

            var _self = event.target;
            var _parent = _self.parentNode;
            var items = accordion.querySelectorAll('.accordion--item');

            if (!_self.classList.contains('accordion--title')) return;

            _parent.classList.toggle('is-open');

            for (var i = 0; i < items.length; i++) {

                if (items[i] === _parent) continue;

                items[i].classList.remove('is-open');
            }
        });
    }; // Accordion

    var CreateList = function CreateList(data) {
        var list = data.rows;
        var items = '';

        list.forEach(function (item, i) {
            var activeClass = i === 0 ? 'is-open' : '';
            items += '\n                <li class="accordion--item ' + activeClass + '">\n                    <h4 class="accordion--title">' + item.title + '</h4>\n                    <div class="accordion--content">\n                        <p>' + item.content + '</p>\n                    </div>\n                </li>\n            ';
        });

        accordion.innerHTML = items;
    }; // CreateList

    var ScrollBar = function ScrollBar() {
        new SimpleBar(document.getElementById('js-faqs'), { autoHide: true });
    }; // ScrollBar


    document.addEventListener('DOMContentLoaded', initAll);
})();